<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω ‚Äî –ê–¥–º–∏–Ω–∫–∞</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; background: #f8f9fa; }
        .product-card { margin-bottom: 1.5rem; }
        .price-badge { font-size: 1.1em; }
    </style>
</head>
<body>
<div class="container">
    <h2 class="mb-4">‚öôÔ∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º —Ü–µ–Ω</h2>

    <div class="card mb-4">
        <div class="card-body">
            <h5>–ü–æ—Ä–æ–≥ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h5>
            <form method="POST" action="/admin/set-threshold" class="row g-2">
                <div class="col-auto">
                    <input type="number" name="threshold" value="{{ threshold }}" class="form-control" min="1">
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
                <div class="col-auto">
                    –£–≤–µ–¥–æ–º–ª—è—Ç—å, –µ—Å–ª–∏ –≤–∞—à–∞ —Ü–µ–Ω–∞ –í–´–®–ï —Ü–µ–Ω—ã Ozon –Ω–∞ —ç—Ç—É —Å—É–º–º—É (‚ÇΩ)
                </div>
            </form>
        </div>
    </div>

    <h4>–¢–æ–≤–∞—Ä—ã (–≤—Å–µ–≥–æ: {{ products|length }})</h4>
    {% for p in products %}
    <div class="card product-card">
        <div class="card-body">
            <form method="POST" action="/admin/edit/{{ p.id }}" class="row g-2 align-items-end">
                <div class="col-md-2">
                    <input type="text" name="name" value="{{ p.name }}" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
                </div>
                <div class="col-md-4">
                    <input type="url" name="url" value="{{ p.url }}" class="form-control" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ Ozon" required>
                </div>
                <div class="col-md-2">
                    <input type="number" name="my_price" value="{{ p.my_price }}" class="form-control" min="1" required>
                </div>
                <div class="col-md-2">
                    {% if p.last_competitor_price %}
                        <span class="badge bg-info price-badge">Ozon: {{ p.last_competitor_price }} ‚ÇΩ</span>
                    {% else %}
                        <span class="badge bg-secondary">–¶–µ–Ω–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å</span>
                    {% endif %}
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-sm btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <a href="/admin/delete/{{ p.id }}" class="btn btn-sm btn-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å?')">–£–¥–∞–ª–∏—Ç—å</a>
                </div>
            </form>
        </div>
    </div>
    {% endfor %}

    <div class="card mt-4">
        <div class="card-header">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</div>
        <div class="card-body">
            <form method="POST" action="/admin/add" class="row g-2">
                <div class="col-md-2">
                    <input type="text" name="name" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
                </div>
                <div class="col-md-4">
                    <input type="url" name="url" class="form-control" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ Ozon" required>
                </div>
                <div class="col-md-2">
                    <input type="number" name="my_price" class="form-control" min="1" placeholder="–í–∞—à–∞ —Ü–µ–Ω–∞" required>
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div class="mt-4">
        <a href="/check" class="btn btn-warning" target="_blank">üîÑ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä—É—á–Ω—É—é</a>
        <a href="/admin/logout" class="btn btn-outline-secondary">–í—ã–π—Ç–∏</a>
    </div>
</div>
</body>
</html>
